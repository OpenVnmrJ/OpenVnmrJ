<?xml version="1.0" encoding="UTF-8" standalone="yes"?>

<template name="shim3d_calib" element="pages" type="acquisition" >
  <group size="797 219"
    style="Label3"
    label="3D Shim Calibs"
    bg="transparent"
    border="None"
    side="Top"
    justify="Left"
    tab="yes"
    enable="no"
    reference="shim3d_calib"
    useref="no"
    subtype="Untitled"
    expanded="yes"
    rows="1"
    columns="1"
    >
    <group loc="535 0" size="255 211"
      style="Heading1"
      label="Field mapping"
      bg="transparent"
      border="Etched"
      side="Top"
      justify="Left"
      tab="no"
      enable="no"
      reference="FieldandShimMapping"
      useref="no"
      subtype="Major"
      expanded="yes"
      rows="1"
      columns="1"
      >
      <label loc="35 45" size="105 20"
        style="Label1"
        label="XY matrix size"
        justify="Left"
        />
      <menu loc="140 45" size="70 20"
        style="PlainText"
        vq="ni"
        vc="gxyzmatrix($VALUE)"
        set="$VALUE=ni"
        editable="No"
        >
        <mlabel 
          label="off"
          chval="0"
          />
        <mlabel 
          label="4x4"
          chval="4"
          />
        <mlabel 
          label="6x6"
          chval="6"
          />
        <mlabel 
          label="8x8"
          chval="8"
          />
        <mlabel 
          label="12x12"
          chval="12"
          />
      </menu>
      <button loc="5 85" size="245 20"
        style="Heading2"
        label="Acquire field-map"
        vc="gxyzmapfield('setup')"
        bg="transparent"
        decor1="yes"
        halignment="Center"
        valignment="Center"
        />
      <button loc="5 105" size="245 20"
        style="Heading2"
        label="Process field-map"
        vc="gxyzmapfield(`map`) gxyzcentre"
        bg="transparent"
        decor1="yes"
        halignment="Center"
        valignment="Center"
        />
      <button loc="5 125" size="245 20"
        style="Heading2"
        label="Process &amp; show fit of shims"
        vc="gxyzmapfield(`process`)"
        bg="transparent"
        decor1="yes"
        halignment="Center"
        valignment="Center"
        />
      <button loc="5 145" size="245 20"
        style="Heading2"
        label="Process &amp; load shims"
        vc="gxyzmapfield(`all`)"
        bg="transparent"
        decor1="yes"
        halignment="Center"
        valignment="Center"
        />
      <button loc="5 165" size="245 20"
        style="Heading2"
        label="Optimize lsfrq1/lsfrq2"
        vc="gxyzcentre"
        bg="transparent"
        decor1="yes"
        halignment="Center"
        valignment="Center"
        />
      <button loc="5 185" size="245 20"
        style="Heading2"
        label="Display amplitude images"
        vc="$gxyzcode=gxyzcode $ni=ni $ni2=ni2 length(gxyzmapcode):$l ni=sqrt($l) ni2=ni gxyzcode=gxyzmapcode disp3Dmap('fieldmap.amp',1,2) gxyzcode=$gxyzcode ni=$ni ni2=$ni2"
        bg="transparent"
        decor1="yes"
        halignment="Center"
        valignment="Center"
        />
    </group>
    <group loc="245 0" size="280 210"
      style="Heading1"
      label="Adjust parameters"
      bg="transparent"
      border="Etched"
      side="Top"
      justify="Left"
      tab="no"
      enable="no"
      reference="Adjust3DShimParameters"
      useref="no"
      subtype="Major"
      expanded="yes"
      rows="1"
      columns="1"
      >
      <label loc="15 30" size="110 20"
        style="Label1"
        label="²H 90-deg. pulse"
        justify="Left"
        />
      <entry loc="125 30" size="45 20"
        style="PlainText"
        vq="lkpw90"
        vc="lkpw90=$VALUE"
        set="$VALUE=lkpw90"
        />
      <label loc="235 30" size="25 20"
        style="Label1"
        label="dB"
        />
      <label loc="170 30" size="35 20"
        style="Label1"
        label="μs @"
        justify="Left"
        />
      <button loc="5 185" size="270 20"
        style="Heading2"
        label="Optimize tau[2]"
        vc="gxyzautocalib('tau2acq','init')"
        bg="transparent"
        decor1="yes"
        halignment="Center"
        valignment="Center"
        />
      <button loc="150 165" size="125 20"
        style="Heading2"
        label="Set from cursors"
        vc="gxyzautocalib('gzwinspec')"
        bg="transparent"
        decor1="yes"
        halignment="Center"
        valignment="Center"
        />
      <button loc="5 165" size="145 20"
        style="Heading2"
        label="Adjust gzwin/lsfrq"
        vc="gxyzautocalib(`gzwinacq`)"
        bg="transparent"
        decor1="yes"
        halignment="Center"
        valignment="Center"
        />
      <button loc="5 145" size="270 20"
        style="Heading2"
        label="Adjust receiver gain"
        vc="gxyzautocalib('gainacq')"
        bg="transparent"
        decor1="yes"
        halignment="Center"
        valignment="Center"
        />
      <button loc="5 125" size="270 20"
        style="Heading2"
        label="Adjust transmitter offset"
        vc="gxyzautocalib(`tofacq`)"
        bg="transparent"
        decor1="yes"
        halignment="Center"
        valignment="Center"
        />
      <button loc="5 105" size="270 20"
        style="Heading2"
        label="Acquire trial profiles"
        vc="gxyzautocalib(`godssh`)"
        bg="transparent"
        decor1="yes"
        halignment="Center"
        valignment="Center"
        />
      <entry loc="205 30" size="30 20"
        style="PlainText"
        vq="lktpwr"
        vc="lktpwr=$VALUE"
        set="$VALUE=lktpwr"
        />
      <button loc="5 55" size="190 20"
        style="Heading2"
        label="Calibrate ²H pw90"
        vc="gxyzautocalib('lkpw90cal')"
        bg="transparent"
        decor1="yes"
        halignment="Center"
        valignment="Center"
        />
      <button loc="195 55" size="80 20"
        style="Heading2"
        label="Reset"
        vc="shell('rm '+userdir+'/3Dshimlib/calibs/lkpw90_'+probe):$dum newdg"
        show="exists(userdir+'/3Dshimlib/calibs/lkpw90_'+probe,'file'):$ex $ENABLE=$ex*2-1"
        bg="transparent"
        decor1="yes"
        halignment="Center"
        valignment="Center"
        />
      <button loc="5 75" size="270 20"
        style="Heading2"
        label="Calibrate X &amp; Y shim strengths"
        vc="gxyzmapsys gxyzautocalib(`xycalib`)"
        bg="transparent"
        decor1="yes"
        halignment="Center"
        valignment="Center"
        />
    </group>
    <group loc="5 0" size="235 208"
      style="Heading1"
      label="Hardware"
      bg="transparent"
      border="Etched"
      side="Top"
      justify="Left"
      tab="no"
      enable="no"
      reference="Hardware"
      useref="no"
      subtype="Major"
      expanded="yes"
      rows="1"
      columns="1"
      >
      <entry loc="145 174" size="30 20"
        style="PlainText"
        vq="gradtype"
        vc="gradtype='$VALUE'"
        set="$VALUE=gradtype"
        />
      <label loc="35 173" size="110 20"
        style="Label1"
        label="Current gradtype:"
        justify="Left"
        />
      <menu loc="80 25" size="105 20"
        style="Label1"
        label="menu"
        vq="tubeid"
        vc="tubeid=$VALUE gxyzsetprobe"
        set="$VALUE=tubeid"
        editable="No"
        >
        <mlabel 
          label="3 mm"
          chval="2.4"
          />
        <mlabel 
          label="5 mm"
          chval="4.2"
          />
        <mlabel 
          label="8 mm"
          chval="7"
          />
        <mlabel 
          label="10 mm"
          chval="9.1"
          />
      </menu>
      <label loc="5 25" size="75 20"
        style="Label1"
        label="Probe type"
        justify="Left"
        />
      <button loc="105 145" size="120 20"
        style="Heading2"
        label="Homospoil ²H"
        vc="gxyzsetpars(`H2HS`)"
        bg="transparent"
        decor1="yes"
        halignment="Center"
        valignment="Center"
        />
      <button loc="105 125" size="120 20"
        style="Heading2"
        label="Homospoil ¹H"
        vc="gxyzsetpars(`H1HS`)"
        bg="transparent"
        decor1="yes"
        halignment="Center"
        valignment="Center"
        />
      <button loc="5 145" size="100 20"
        style="Heading2"
        label="Z-PFG ²H"
        vc="gxyzsetpars(`H2PFG`)"
        bg="transparent"
        decor1="yes"
        halignment="Center"
        valignment="Center"
        />
      <button loc="5 125" size="100 20"
        style="Heading2"
        label="Z-PFG ¹H"
        vc="gxyzsetpars(`H1PFG`)"
        bg="transparent"
        decor1="yes"
        halignment="Center"
        valignment="Center"
        />
      <label loc="5 105" size="115 20"
        style="Label1"
        label="Gradient, nucleus"
        />
      <label loc="5 50" size="40 20"
        style="Label1"
        label="Shims"
        justify="Left"
        />
      <check loc="25 75" size="195 20"
        style="Label1"
        label="²H shimming relays installed"
        vq="lkflg"
        vc="lkflg='y'"
        vc2="lkflg='n'"
        set="if lkflg='y' then $VALUE=1 else $VALUE=0 endif"
        />
      <textmessage loc="50 50" size="190 20"
        style="PlainText"
        vq="shimset"
        label="Agilent 27 channel"
        set="shimset:$VALUE"
        />
    </group>
  </group>
</template>
