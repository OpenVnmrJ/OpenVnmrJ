<?xml version="1.0" encoding="UTF-8" standalone="yes"?>

<template name="shim3d2" element="pages" type="acquisition" >
  <group size="745 340"
    style="Heading1"
    label="More 3D Shim"
    bg="transparent"
    border="None"
    side="Top"
    justify="Left"
    tab="yes"
    enable="no"
    reference="shim3d2"
    useref="no"
    subtype="Convenience"
    expanded="yes"
    >
    <group loc="20 5" size="265 300"
      style="Heading2"
      label="3D Autoshimming"
      bg="transparent"
      border="etched"
      side="Top"
      justify="Left"
      tab="no"
      enable="no"
      reference="3DAutoshimming"
      useref="no"
      subtype="Major"
      expanded="yes"
      >
      <entry loc="180 70" size="50 20"
        style="PlainText"
        vq="ncycles"
        vc="ncycles=$VALUE"
        set="$VALUE=ncycles"
        />
      <label loc="15 70" size="150 20"
        style="Label1"
        label="Number of shim cycles:"
        justify="Right"
        />
      <label loc="20 100" size="75 20"
        style="Label1"
        label="Shims to fit:"
        justify="Right"
        />
      <filemenu loc="95 100" size="130 20"
        style="PlainText"
        vq="gxyzfitgroup"
        vc="gxyzfitgroup='$VALUE' gxyzfitshims"
        set="$VALUE=gxyzfitgroup"
        file="$VALUE=userdir+'/persistence/gxyzshimgroup'"
        type="file"
        editable="No"
        statshow="yes"
        elastic="no"
        display="yes"
        />
      <check loc="5 125" size="180 15"
        style="PlainText"
        label="Automatically adjust tau[2]"
        vq="varytau"
        vc="varytau='y'"
        vc2="varytau='n'"
        set="$VALUE=(varytau='y')"
        />
      <check loc="5 145" size="80 15"
        style="PlainText"
        label="Auto Plot"
        vq="pltopt"
        vc="pltopt='y'"
        vc2="pltopt='n'"
        set="$VALUE=(pltopt='y')"
        />
      <check loc="5 160" size="260 25"
        style="PlainText"
        label="Measure 1D spectra between shim cycles"
        vq="ref1Dflg"
        vc="ref1Dflg='y'"
        vc2="ref1Dflg='n'"
        set="if ref1Dflg='y' then $VALUE=1 else $VALUE=0 endif"
        />
      <group loc="10 185" size="245 110"
        vq="ref1Dflg"
        show="$SHOW=(ref1Dflg='y')"
        bg="transparent"
        border="None"
        side="Top"
        justify="Left"
        tab="no"
        enable="no"
        useref="no"
        subtype="Minor"
        >
        <label loc="25 5" size="125 20"
          style="Label1"
          label="Chemical shift of ref.:"
          justify="Right"
          />
        <label loc="40 65" size="110 20"
          style="Label1"
          label="Pulse power level:"
          justify="Right"
          />
        <label loc="60 85" size="90 20"
          style="Label1"
          label="Receiver gain:"
          justify="Right"
          />
        <label loc="35 45" size="115 20"
          style="Label1"
          label="Pulse width:"
          justify="Right"
          />
        <label loc="35 25" size="115 20"
          style="Label1"
          label="Observe nucleus:"
          justify="Right"
          />
        <entry loc="165 85" size="50 20"
          style="PlainText"
          vq="refgain"
          vc="refgain=$VALUE"
          set="$VALUE=refgain"
          />
        <entry loc="165 65" size="50 20"
          style="PlainText"
          vq="refpwr"
          vc="reftpwr=$VALUE"
          set="$VALUE=reftpwr"
          />
        <entry loc="165 45" size="50 20"
          style="PlainText"
          vq="refpw"
          vc="refpw=$VALUE"
          set="$VALUE=refpw"
          />
        <label loc="215 85" size="25 20"
          style="Label1"
          label="dB"
          />
        <label loc="215 65" size="25 20"
          style="Label1"
          label="dB"
          />
        <label loc="215 45" size="25 20"
          style="Label1"
          label="us"
          />
        <entry loc="165 25" size="50 20"
          style="PlainText"
          vq="refnuc"
          vc="refnuc=$VALUE"
          set="$VALUE=refnuc"
          />
        <entry loc="165 5" size="50 20"
          style="PlainText"
          vq="refppm"
          vc="refppm=$VALUE"
          set="$VALUE=refppm"
          />
        <label loc="215 5" size="30 20"
          style="Label1"
          label="ppm"
          />
      </group>
      <button loc="10 25" size="245 30"
        style="Heading1"
        label="Start 3D Autoshimming"
        vc="gxyzautoshim"
        show="exists(userdir+'/3Dshimlib/shimmaps/'+mapname+'/'+mapname+'.fid','directory'):$ex if $ex &gt;0.5 then $ENABLE=1 else $ENABLE=0 endif"
        bg="transparent"
        decor1="yes"
        />
    </group>
    <group loc="320 250" size="280 55"
      style="Heading2"
      label="Quit"
      bg="transparent"
      border="etched"
      side="Top"
      justify="Left"
      tab="no"
      enable="no"
      reference="Quit"
      useref="no"
      subtype="Major"
      expanded="yes"
      >
      <button loc="10 20" size="260 30"
        style="Heading4"
        label="Quit 3D Shimming"
        vc="gxyzmapsys('exit')"
        show="expactive:$tmp if $tmp&gt;0.5 then $ENABLE=0 else $ENABLE=1 endif"
        bg="transparent"
        decor1="yes"
        />
    </group>
    <group loc="320 160" size="280 90"
      style="Heading2"
      label="Shims"
      bg="transparent"
      border="etched"
      side="Top"
      justify="Left"
      tab="no"
      enable="no"
      reference="OtherUtilities"
      useref="no"
      subtype="Major"
      expanded="yes"
      >
      <button loc="25 20" size="235 20"
        style="Label3"
        label="Load shims from current shim-maps"
        vc="rts('tmp'+mapname) load='y' su"
        bg="transparent"
        decor1="no"
        />
      <button loc="25 60" size="235 20"
        style="Label3"
        label="Display approx. shim power dissipation"
        vc="gxyzshimpwr"
        bg="transparent"
        decor1="no"
        />
      <button loc="25 40" size="235 20"
        style="Label3"
        label="Read shims from hardware"
        vc="readallshims write('line3','Shims read from hardware')"
        bg="transparent"
        decor1="no"
        />
    </group>
    <group loc="320 55" size="280 105"
      style="Heading2"
      label="Display / Plot"
      bg="transparent"
      border="etched"
      side="Top"
      justify="Left"
      tab="no"
      enable="no"
      reference="Displayinh"
      useref="no"
      subtype="Major"
      expanded="yes"
      >
      <button loc="20 80" size="240 20"
        style="Label3"
        label="Display autoshimming log file"
        vc="gxyzshimlog"
        show="exists(userdir+'/3Dshimlib/calibs/shimlog.txt','file'):$e if $e then $ENABLE=1 else $ENABLE=0 endif"
        bg="transparent"
        decor1="yes"
        />
      <filemenu loc="150 20" size="110 20"
        style="PlainText"
        vq="gxyzshimdisp"
        vc="gxyzshimdisp='$VALUE'"
        set="$VALUE=gxyzshimdisp"
        file="$VALUE=userdir+'/persistence/gxyzshimdisp'"
        type="file"
        editable="No"
        statshow="yes"
        elastic="no"
        display="yes"
        />
      <button loc="20 60" size="240 20"
        style="Label3"
        label="Plot all shim-maps"
        vc="gxyzdispmap('plot','all')"
        bg="transparent"
        decor1="no"
        />
      <button loc="20 40" size="240 20"
        style="Label3"
        label="Display shim-map amp. images"
        vc="disp3Dmap('shimmaps.amp')"
        bg="transparent"
        decor1="no"
        />
      <button loc="20 20" size="130 20"
        style="Label3"
        label="Display maps of"
        vc="gxyzdispmap('display','custom')"
        bg="transparent"
        decor1="no"
        />
    </group>
    <group loc="320 5" size="280 50"
      style="Heading2"
      label="Shim-map Files"
      bg="transparent"
      border="etched"
      side="Top"
      justify="Left"
      tab="no"
      enable="no"
      reference="Shim-mapFiles"
      useref="no"
      subtype="Major"
      expanded="yes"
      >
      <filemenu loc="15 20" size="250 25"
        style="Label1"
        vq="mapname"
        vc="gxyzrtmap('$VALUE')"
        set="$VALUE=mapname"
        file="$VALUE=userdir+'/3Dshimlib/shimmaps'"
        type="directory"
        editable="No"
        statshow="no"
        elastic="no"
        display="yes"
        />
    </group>
  </group>
</template>
