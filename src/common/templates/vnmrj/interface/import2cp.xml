<?xml version="1.0" encoding="UTF-8" standalone="yes"?>

<template name="import2cp" element="groups" type="acquisition" >
  <group size="700 800"
    border="None"
    tab="no"
    enable="no"
    reference="import2cp"
    useref="no"
    subtype="Convenience"
    expanded="yes"
    >
    <textmessage loc="25 15" size="660 25"
      style="Info"
      vq="import2cppar file"
      set="$base='' is_cpfid:$cpfid if ($cpfid) then $base=' (already converted)' endif $VALUE='Study in current workspace'+$base+':'"
      />
    <group loc="20 40" size="660 90"
      border="Etched"
      tab="no"
      enable="no"
      useref="no"
      subtype="Basic"
      >
      <label loc="15 5" size="120 20"
        style="Label1"
	label="FID name:"
	justify="Right"
        />
      <textmessage loc="145 5" size="480 20"
        style="PlainText"
        vq="import2cppar file"
        set="$base='' shell('basename '+file):$base $VALUE=$base"
        />
      <label loc="15 25" size="120 20"
        style="Label1"
        label="Sample directory:"
        justify="Right"
        />
      <textmessage loc="145 25" size="480 20"
        style="PlainText"
        vq="import2cppar file"
        set="$base='' is_cpfid:$cpfid if ($cpfid) then shell('dirname '+file):$base shell('basename '+$base):$base endif $VALUE=$base"
        />
      <label loc="15 45" size="120 20"
        style="Label1"
        label="Data directory:"
        justify="Right"
        />
      <textmessage loc="145 45" size="480 20"
        style="PlainText"
        vq="import2cppar file"
        set="$base='' shell('dirname '+file):$base is_cpfid:$cpfid if ($cpfid) then shell('dirname '+$base):$base endif $VALUE=$base"
        />
      <label loc="15 65" size="120 20"
        style="Label1"
        label="Study owner:"
        justify="Right"
        /> 
      <textmessage loc="145 65" size="480 20"
        style="PlainText"
        vq="import2cppar file"
        set="exists('operator_','parameter'):$parex $base='' if ($parex) then $base=operator_ endif $VALUE=$base"
        />
    </group>
    <label loc="20 140" size="235 25"
      style="Info"
      label="Read from:"
      />
    <group loc="20 165" size="660 210"
      border="Etched"
      tab="no"
      enable="no"
      useref="no"
      subtype="Basic"
      >
      <label loc="15 10" size="275 20"
        style="Label1"
        label="Recent source directories"
        />
      <button loc="375 8" size="150 25"
        style="Heading2"
        label="Update directory list"
        vq="import2cppar file"
        show="$ENABLE=((file&lt;&gt;import2cppar[1]) and (file&lt;&gt;import2cppar[1]+'.fid'))*2-1"
        vc="shell('dirname '+file):$dir import2cp('updatedir',$dir)"
        />
      <filemenu loc="25 35" size="500 20"
        style="PlainText"
        vq="import2cppar"
        vc="import2cppar[14]='$VALUE' import2cp('populatefid')"
        set="$VALUE=import2cppar[14]"
        file="$VALUE=userdir+'/persistence/import2cp/imp2cp_exportdir'"
        type="file"
        editable="No"
        vq2="import2cppar"
        statshow="no"
        elastic="no"
        display="yes"
        />
      <button loc="530 35" size="90 25"
        style="Heading2"
        label="Browser"
        vq="import2cppar"
        vc="vnmrjcmd('LOC openDataPanel')"
        />
      <label loc="15 55" size="275 20"
        style="Label1"
        label="FIDs in this directory"
        />
      <filemenu loc="25 75" size="300 20"
        style="PlainText"
        vq="import2cppar"
        vc="import2cppar[5]='$VALUE'"
        set="$VALUE=import2cppar[5]"
        file="$VALUE=userdir+'/persistence/import2cp/imp2cp_fidmenu'"
        type="file"
        editable="No"
        vq2="import2cppar"
        statshow="no"
        elastic="no"
        display="yes"
        />
      <button loc="340 75" size="90 25"
        style="Heading2"
        label="Add"
        vq="import2cppar"
        vc="import2cp('add')"
        show="$ENABLE=((import2cppar[5]&lt;&gt;'') and (import2cppar[4]='selfid'))*2-1"
        />
      <button loc="530 75" size="90 25"
        style="Heading2"
        label="Add all"
        vq="import2cppar"
        vc="import2cp('addall')"
        show="$ENABLE=(import2cppar[4]='selfid')*2-1"
        />
      <button loc="435 75" size="90 25"
        style="Heading2"
        label="Remove"
        vq="import2cppar"
        vc="import2cp('remove')"
        show="$ENABLE=((import2cppar[5]&lt;&gt;'') and (import2cppar[4]='selfid'))*2-1"
        />
      <label loc="15 100" size="600 20"
        style="Label1"
        label="Convert FIDs in this list"
        vq="import2cppar"
        />
      <button loc="530 105" size="90 25"
        style="Heading2"
        label="Clear list"
        vq="import2cppar"
        vc="import2cp('removeall')"
        show="$ENABLE=(import2cppar[4]='selfid')*2-1"
        />
      <textfile loc="25 130" size="600 75"
        style="PlainText"
        vq="import2cppar"
        set="$VALUE=userdir+'/persistence/import2cp/imp2cp_fids'"
        editable="no"
        wrap="no"
        units="char"
        />
    </group>
    <label loc="20 385" size="235 25"
      style="Info"
      label="Convert and resave:"
      />
    <group loc="20 410" size="660 380"
      border="Etched"
      vq="import2cppar"
      tab="no"
      enable="no"
      useref="no"
      subtype="Basic"
      >
      <label loc="5 5" size="50 20"
        style="Label1"
        label="To a  "
        justify="Right"
        />
      <radio loc="75 5" size="340 20"
        style="Label1"
        label="Newly created directory based on templates"
        vq="import2cppar"
        vc="import2cppar[6]='y' import2cp('sampletags') import2cp('examplename')"
        vc2="import2cppar[6]='n' import2cp('sampletags',import2cppar[7]) import2cp('examplename')"
        set="$VALUE=(import2cppar[6]='y')"
        />
      <radio loc="410 5" size="240 20"
        style="Label1"
        label="Specified directory"
        vq="import2cppar"
        vc="import2cppar[6]='n' import2cp('sampletags',import2cppar[7]) import2cp('examplename')"
        vc2="import2cppar[6]='y' import2cp('sampletags') import2cp('examplename')"
        set="$VALUE=(import2cppar[6]='n')"
        />
      <label loc="15 30" size="200 20"
        style="Label1"
        label="Study directory template:"
        justify="Right"
        />
      <entry loc="220 30" size="400 20"
        style="PlainText"
        vq="import2cppar"
        vc="import2cppar[11]='$VALUE' import2cp('examplename')"
        set="$VALUE=import2cppar[11]"
        show="$ENABLE=(import2cppar[6]='y')*2-1"
        />
      <label loc="15 50" size="200 20"
        style="Label1"
        label="Sample directory template:"
        justify="Right"
        />
      <entry loc="220 50" size="400 20"
        style="PlainText"
        vq="import2cppar"
        vc="import2cppar[12]='$VALUE' import2cp('examplename')"
        set="$VALUE=import2cppar[12]"
        show="$ENABLE=(import2cppar[6]='y')*2-1"
        />
      <label loc="15 70" size="200 20"
        style="Label1"
        label="Data template:"
        justify="Right"
        />
      <entry loc="220 70" size="400 20"
        style="PlainText"
        vq="import2cppar"
        vc="import2cppar[13]='$VALUE' import2cp('examplename')"
        set="$VALUE=import2cppar[13]"
        />
      <label loc="15 100" size="140 20"
        style="Label1"
        label="Specific directory path:"
        justify="Right"
        />
      <entry loc="160 100" size="460 20"
        style="PlainText"
        vq="import2cppar"
        vc="import2cppar[7]='$VALUE' import2cp('sampletags','$VALUE') import2cp('examplename')"
        set="$VALUE=import2cppar[7]"
        show="$ENABLE=(import2cppar[6]='n')*2-1"
        />
      <label loc="15 120" size="140 20"
        style="Label1"
        label="Recent directories:"
        justify="Right"
        />
      <filemenu loc="160 120" size="460 20"
        style="PlainText"
        vq="import2cppar"
        vc="import2cppar[7]='$VALUE' import2cp('sampletags','$VALUE') import2cp('examplename')"
        set="$VALUE=import2cppar[7]"
        file="$VALUE=userdir+'/persistence/import2cp/imp2cp_importdir'"
        type="file"
        editable="No"
        show="$ENABLE=(import2cppar[6]='n')*2-1"
        vq2="import2cppar"
        statshow="no"
        elastic="no"
        display="yes"
        />
      <label loc="25 140" size="120 20"
        style="Label1"
        label="Examples:"
        />
      <label loc="40 150" size="175 20"
        style="Label1"
        label="Study directory:"
        justify="Right"
        />
      <textmessage loc="220 150" size="400 20"
        style="PlainText"
        label=""
        vq="import2cppar"
        set="$VALUE=import2cppar[8]"
        />
      <label loc="40 170" size="175 20"
        style="Label1"
        label="Sample directory:"
        justify="Right"
        />
      <textmessage loc="220 170" size="400 20"
        style="PlainText"
        label=""
        vq="import2cppar"
        set="$VALUE=import2cppar[9]"
        />
      <label loc="40 190" size="175 20"
        style="Label1"
        label="Data:"
        justify="Right"
        />
      <textmessage loc="220 190" size="400 20"
        style="PlainText"
        label=""
        vq="import2cppar"
        set="$VALUE=import2cppar[10]"
        />
      <label loc="420 220" size="130 20"
        style="Label1"
        label="SampleTag details"
        />
      <textfile loc="420 240" size="200 100"
        style="PlainText"
        vq="userdir import2cppar"
        set="$VALUE=userdir+'/persistence/import2cp/imp2cp_sampletags'"
        editable="no"
        wrap="no"
        units="char"
        />
      <button loc="420 345" size="200 25"
        style="Heading2"
        label="Change SampleTag values"
        vq="import2cppar"
        vc="import2cp('popup')"
        show="$ENABLE=(import2cppar[15]='y')*2-1"
        />
      <button loc="90 300" size="120 25"
        style="Heading4"
        label="Convert"
        vq="import2cppar"
	show="$ENABLE=(import2cppar[16]&lt;&gt;'0')*2-1"
        vc="import2cp('import')"
        />
    </group>
  </group>
</template>
