<?xml version="1.0" encoding="UTF-8" standalone="yes"?>

<template name="NUGcalib" element="pages" type="processing" >
  <group size="725 260"
    style="Heading1"
    label="NUG Calib"
    bg=""
    border="None"
    side="Top"
    justify="Left"
    tab="yes"
    enable="no"
    reference="NUGcalib"
    useref="no"
    subtype="Basic"
    expanded="yes"
    >
    <group loc="315 170" size="390 85"
      style="Heading1"
      label="Display/Plot"
      bg=""
      border="etched"
      side="Top"
      justify="Left"
      tab="no"
      enable="no"
      reference="Display/Plot"
      useref="no"
      subtype="Major"
      expanded="yes"
      >
      <button loc="200 60" size="180 20"
        style="Heading2"
        label="Plot apparent D wrt position"
        vc="redosy axis='hD' pcon write('plotter',wcmax*0.35,wc2max-35,'Variation in apparent diffusion coefficient as a function of position')  page"
        bg=""
        decor1=""
        />
      <button loc="200 40" size="180 20"
        style="Heading2"
        label="Plot fitted signal decay"
        vc="shownugfit('plot')"
        bg=""
        decor1=""
        />
      <button loc="10 60" size="180 20"
        style="Heading2"
        label="Show apparent D wrt position"
        vc="redosy axis='hD' dconi write('graphics',wcmax*0.35,wc2max-35,'Variation in apparent diffusion coefficient as a function of position') "
        bg=""
        decor1=""
        />
      <button loc="10 40" size="180 20"
        style="Heading2"
        label="Show fitted signal decay"
        vc="shownugfit"
        bg=""
        decor1=""
        />
      <button loc="200 20" size="180 20"
        style="Heading2"
        label="Plot fitted gradient shape"
        vc="showgradfit('plot')"
        bg=""
        decor1=""
        />
      <button loc="10 20" size="180 20"
        style="Heading2"
        label="Show fitted gradient shape"
        vc="showgradfit"
        bg=""
        decor1=""
        />
    </group>
    <group loc="315 0" size="390 165"
      style="Heading1"
      label="NUG coefficients"
      bg=""
      border="etched"
      side="Top"
      justify="Left"
      tab="no"
      enable="no"
      reference="Data"
      useref="no"
      subtype="Major"
      expanded="yes"
      >
      <group loc="200 20" size="175 140"
        bg=""
        border="None"
        side="Top"
        justify="Left"
        tab="no"
        enable="no"
        reference="NUGcoefficients"
        useref="no"
        subtype="Minor"
        expanded="yes"
        >
        <label loc="0 0" size="90 20"
          style="Heading1"
          label="System coeffs"
          />
        <textmessage loc="10 20" size="145 20"
          style="PlainText"
          label="gcal         = 0.0018600"
          vq="gcal_"
          set="$str='' format(gcal_,1,7):$str $VALUE='gcal         = '+$str"
          />
        <textmessage loc="10 40" size="160 20"
          style="PlainText"
          label="nugcal[1] = 0.0018600"
          vq="nugcal[1]"
          set="$str='' format( nugcal[1],1,7):$str $VALUE='nugcal[1] = '+$str"
          />
        <textmessage loc="10 60" size="160 20"
          style="PlainText"
          label="nugcal[2] = 1.1439595"
          vq="nugcal[2]"
          set="$str='' format( nugcal[2],1,7):$str $VALUE='nugcal[2] = '+$str"
          />
        <textmessage loc="10 80" size="160 20"
          style="PlainText"
          label="nugcal[3] = -0.0323794"
          vq="nugcal[3]"
          set="$str='' format( nugcal[3],1,7):$str $VALUE='nugcal[3] = '+$str"
          />
        <textmessage loc="10 100" size="160 20"
          style="PlainText"
          label="nugcal[4] = -0.0018333"
          vq="nugcal[4]"
          set="$str='' format( nugcal[4],1,7):$str $VALUE='nugcal[4] = '+$str"
          />
        <textmessage loc="10 120" size="160 20"
          style="PlainText"
          label="nugcal[5] = 0.0001911"
          vq="nugcal_[5]"
          set="$str='' format( nugcal[5],1,7):$str $VALUE='nugcal[5] = '+$str"
          />
      </group>
      <group loc="10 20" size="180 140"
        bg=""
        border="None"
        side="Top"
        justify="Left"
        tab="no"
        enable="no"
        reference="NUGcoefficients"
        useref="no"
        subtype="Minor"
        expanded="yes"
        >
        <label loc="0 0" size="110 20"
          style="Heading1"
          label="Corrected coeffs"
          />
        <textmessage loc="10 20" size="160 20"
          style="PlainText"
          label="gcal_corrd = 0.0019890"
          set="$str='' getparam('gcal_corrd','Probe'):$tmp format( $tmp,1,7):$str $VALUE='gcal_corrd = '+$str"
          />
        <textmessage loc="10 40" size="160 20"
          style="PlainText"
          label="nugcal_[1] = 0.0020500"
          vq="nugcal_[1]"
          set="$str='' format( nugcal_[1],1,7):$str $VALUE='nugcal_[1] = '+$str"
          />
        <textmessage loc="10 60" size="160 20"
          style="PlainText"
          label="nugcal_[2] = 1.0000000"
          vq="nugcal_[2]"
          set="$str='' format( nugcal_[2],1,7):$str $VALUE='nugcal_[2] = '+$str"
          />
        <textmessage loc="10 80" size="160 20"
          style="PlainText"
          label="nugcal_[3] = 0.0000000"
          vq="nugcal_[3]"
          set="$str='' format( nugcal_[3],1,7):$str $VALUE='nugcal_[3] = '+$str"
          />
        <textmessage loc="10 100" size="160 20"
          style="PlainText"
          label="nugcal_[4] = 0.0000000"
          vq="nugcal_[4]"
          set="$str='' format( nugcal_[4],1,7):$str $VALUE='nugcal_[4] = '+$str"
          />
        <textmessage loc="10 120" size="160 20"
          style="PlainText"
          label="nugcal_[5] = 0.0000000"
          vq="nugcal_[5]"
          set="$str='' format( nugcal_[5],1,7):$str $VALUE='nugcal_[5] = '+$str"
          />
      </group>
    </group>
    <group loc="5 0" size="305 255"
      style="Heading1"
      label="Processing"
      bg=""
      border="etched"
      side="Top"
      justify="Left"
      tab="no"
      enable="no"
      reference="deg"
      useref="no"
      subtype="Major"
      expanded="yes"
      >
      <menu loc="200 80" size="95 20"
        style="PlainText"
        label="Sample"
        vq="nug_sample"
        vc="nug_sample='$VALUE'"
        set="$VALUE=nug_sample"
        editable="No"
        >
        <mlabel 
          label="Pure H2O"
          chval="w"
          />
        <mlabel 
          label="1% HOD"
          chval="d"
          />
        <mlabel 
          label="other"
          chval="o"
          />
      </menu>
      <button loc="10 50" size="285 20"
        style="Heading2"
        label="Baseline Correct All Profiles"
        vc="region fbc"
        bg=""
        decor1=""
        />
      <button loc="10 25" size="285 20"
        style="Heading2"
        label="Fourier Transform Profiles"
        vc="wft"
        bg=""
        decor1=""
        />
      <button loc="10 215" size="285 30"
        style="Heading2"
        label="Calculate NUG coefficients"
        vq="nug_sample nug_temp nug_globalcopy nug_probefile nug_D"
        vc="if nug_sample='o' then nugcalib(nug_sample,nug_D,nug_globalcopy,nug_probefile) else nugcalib(nug_sample,nug_temp,nug_globalcopy,nug_probefile) endif"
        bg=""
        decor1=""
        />
      <entry loc="180 105" size="45 20"
        style="PlainText"
        vq="nug_D nug_sample"
        vc="nug_D=$VALUE"
        set="$VALUE=nug_D"
        show="$ENABLE=(nug_sample='o')*2-1"
        digits="2"
        />
      <entry loc="180 130" size="45 20"
        style="PlainText"
        vq="nug_temp"
        vc="nug_temp=$VALUE"
        set="$VALUE=nug_temp"
        digits="1"
        />
      <label loc="230 130" size="45 20"
        style="Label1"
        label="deg. C"
        />
      <label loc="230 105" size="75 20"
        style="Label1"
        label="10⁻¹⁰ m²/s"
        />
      <label loc="10 130" size="170 20"
        style="Label1"
        label="Mapping data measured at:"
        justify="Left"
        />
      <label loc="10 105" size="130 20"
        style="Label1"
        label="D value for calibrant:"
        justify="Left"
        />
      <label loc="10 80" size="190 20"
        style="Label1"
        label="Calibrant for gradient mapping:"
        justify="Left"
        />
      <check loc="35 160" size="250 25"
        style="Label1"
        label="Copy NUG coeffs to global parameters"
        vq="nug_globalcopy"
        vc="nug_globalcopy='y'"
        vc2="nug_globalcopy='n'"
        set="$VALUE=(nug_globalcopy='y')"
        />
      <check loc="35 185" size="240 25"
        style="Label1"
        label="Store/update NUG coeffs in probe file"
        vq="nug_probefile"
        vc="nug_probefile='y'"
        vc2="nug_probefile='n'"
        set="$VALUE=(nug_probefile='y')"
        />
    </group>
  </group>
</template>
