<?xml version="1.0" encoding="UTF-8" standalone="yes"?>

<template name="NUS" element="pages" type="processing" >
  <group size="795 220"
    style="PlainText"
    label="NUS"
    vq="sampling"
    show="$SHOW=0 exists('sampling','parameter'):$e if $e=1 then if sampling='sparse' then $SHOW=1 else $SHOW=0 endif endif"
    bg="transparent"
    border="None"
    side="Top"
    justify="Left"
    tab="yes"
    enable="no"
    reference="NUS"
    useref="no"
    subtype="Untitled"
    expanded="yes"
    rows="1"
    columns="1"
    >
    <group loc="0 5" size="785 215"
      bg="transparent"
      border="None"
      tab="no"
      enable="no"
      reference="clean_proc"
      useref="no"
      subtype="Untitled"
      expanded="yes"
      rows="1"
      columns="1"
      >
      <label loc="490 195" size="160 25"
        style="Label1"
        label="and present in current exp"
        />
      <label loc="205 195" size="285 25"
        style="Label1"
        label="Note: Sampling schedule must be &quot;sampling.sch&quot;"
        />
      <button loc="10 180" size="185 25"
        style="Heading2"
        label="Restore Raw Data"
        vq="file"
        vc="if file&lt;&gt;'' then rt(file) write('line3','Raw NUS data restored') wft(1) endif"
        bg="transparent"
        decor1="yes"
        halignment="Center"
        valignment="Center"
        />
      <button loc="10 150" size="185 25"
        style="Heading2"
        label="Save Raw Data Now"
        vq="svfdif svfname"
        vc="BPsvf(svfdir+'/'+svfname)"
        bg="transparent"
        decor1="no"
        halignment="Center"
        valignment="Center"
        />
      <group loc="205 60" size="200 135"
        vq="CSreconmethod"
        show="if CSreconmethod='CLEAN' then $SHOW=1 else $SHOW=0 endif"
        bg="transparent"
        border="None"
        tab="no"
        enable="no"
        useref="no"
        subtype="Untitled"
        rows="1"
        columns="1"
        >
        <label loc="20 110" size="110 25"
          style="Label1"
          label="noise threshold"
          vq="CS_cln"
          show="if(CS_cln='y') then $SHOW=1 else $SHOW=0 endif"
          />
        <entry loc="150 110" size="35 25"
          style="PlainText"
          vq="CSthr CS_cln"
          vc="CSthr=$VALUE if (CSthr&lt;1.0) then CSthr = 1.0 endif"
          set="if (CSthr&lt;1.0) then CSthr = 1.0 endif $VALUE=CSthr"
          show="if (CS_cln='y') then $SHOW=1 else $SHOW=0 endif"
          digits="1"
          />
        <check loc="90 85" size="80 25"
          style="PlainText"
          label="de-noise"
          vq="CSdnoise CS_cln"
          vc="CSdnoise='y'"
          vc2="CSdnoise='n'"
          set="if (CSdnoise='y') then $VALUE=1 else $VALUE=0 endif"
          show="if (CS_cln='y') then $SHOW=1 else $SHOW=0 endif"
          />
        <check loc="5 85" size="65 25"
          style="PlainText"
          label="inflate"
          vq="CS_inf"
          vc="CS_inf='y'"
          vc2="CS_inf='n'"
          set="if CS_inf='y' then $VALUE=1 else $VALUE=0 endif"
          />
        <check loc="5 65" size="170 25"
          style="PlainText"
          label="sensitivity enhanced data"
          vq="CS_se"
          vc="CS_se='y'"
          vc2="CS_se='n'"
          set="if CS_se='y' then $VALUE=1 else $VALUE=0 endif"
          />
        <group loc="20 45" size="165 20"
          vq="CSwp"
          show="if CSwp=0 then $VALUE=0 else $VALUE=1 endif"
          bg="transparent"
          border="None"
          tab="no"
          enable="no"
          useref="no"
          subtype="Untitled"
          rows="1"
          columns="1"
          >
          <selmenu loc="0 0" size="145 20"
            style="Label1"
            label="Use Region of Width:"
            vq="crmode"
            vc="NUSselect($VALUE) if not (crmode='b') then ds('toggle') endif"
            editable="No"
            >
            <mlabel 
              label="sw/2"
              chval="2"
              />
            <mlabel 
              label="sw/4"
              chval="4"
              />
            <mlabel 
              label="sw/8"
              chval="8"
              />
            <mlabel 
              label="sw/16"
              chval="16"
              />
          </selmenu>
        </group>
        <check loc="0 20" size="130 25"
          style="Label1"
          label="Partial Region"
          vq="crmode"
          vc="NUSselect(0) if not (crmode='b') then ds('toggle') endif"
          vc2="CSwp=0 if(crmode='b') then ds('toggle') endif"
          set="$VALUE=CSwp"
          />
        <check loc="0 0" size="200 25"
          style="PlainText"
          label="use default processing params"
          vq="CS_dpars"
          vc="CS_dpars='y'"
          vc2="CS_dpars='n'"
          set="if CS_dpars='y' then $VALUE=1 else $VALUE=0 endif"
          />
      </group>
      <group loc="205 35" size="205 20"
        bg="transparent"
        border="None"
        tab="no"
        enable="no"
        useref="no"
        subtype="Untitled"
        rows="1"
        columns="1"
        >
        <menu loc="100 0" size="80 20"
          style="PlainText"
          label="menu"
          vq="pipeELB CS_cln"
          vc="CSreconmethod='$VALUE' if '$VALUE'='CLEAN' then CS_cln='y' endif exists('pipeELB','parameter'):$e if $e=0 then mkISTparams endif"
          set="$VALUE=CSreconmethod"
          editable="No"
          >
          <mlabel 
            label="CLEAN"
            chval="CLEAN"
            />
          <mlabel 
            label="IST"
            chval="IST"
            />
        </menu>
        <label loc="0 0" size="100 20"
          style="Label1"
          label="Recon. method"
          />
      </group>
      <button loc="440 155" size="90 25"
        style="Heading2"
        label="Manual"
        vc="man('CS')"
        bg="transparent"
        decor1="no"
        halignment="Center"
        valignment="Center"
        />
      <group loc="555 5" size="230 185"
        vq="CSreconmethod CS_dpars"
        show="if CSreconmethod='IST' then $SHOW=1 else $SHOW=0 endif"
        bg="transparent"
        border="None"
        tab="no"
        enable="no"
        useref="false"
        subtype="Untitled"
        rows="1"
        columns="1"
        >
        <label loc="5 165" size="95 20"
          style="Label1"
          label="Residual"
          />
        <label loc="150 165" size="25 20"
          style="Label1"
          label="%"
          justify="Center"
          />
        <entry loc="100 165" size="50 20"
          style="PlainText"
          vq="pipeistTMult"
          vc="pipeistTMult='$VALUE'"
          set="$VALUE=pipeistTMult"
          />
        <label loc="5 0" size="115 25"
          style="Heading2"
          label="IST Parameters"
          justify="Left"
          />
        <label loc="150 20" size="50 20"
          style="Label1"
          label="F2"
          justify="Center"
          />
        <label loc="100 20" size="50 20"
          style="Label1"
          label="F1"
          justify="Center"
          />
        <label loc="5 40" size="95 20"
          style="Label1"
          label="Exp LB"
          />
        <label loc="200 40" size="25 20"
          style="Label1"
          label="Hz"
          justify="Center"
          />
        <entry loc="100 40" size="50 20"
          style="PlainText"
          vq="pipeELB[2]"
          vc="pipeELB[2]='$VALUE' "
          set="$VALUE=pipeELB[2]"
          />
        <entry loc="150 40" size="50 20"
          style="PlainText"
          vq="pipeELB[1]"
          vc="pipeELB[1]='$VALUE'"
          set="$VALUE=pipeELB[1]"
          />
        <label loc="5 60" size="95 20"
          style="Label1"
          label="Gaussian LB"
          />
        <label loc="200 60" size="25 20"
          style="Label1"
          label="Hz"
          justify="Center"
          />
        <entry loc="150 60" size="50 20"
          style="PlainText"
          vq="pipeELB[1]"
          vc="pipeELB[1]='$VALUE'"
          set="$VALUE=pipeELB[1]"
          />
        <entry loc="100 60" size="50 20"
          style="PlainText"
          vq="pipeGLB[2]"
          vc="pipeGLB[2]='$VALUE'"
          set="$VALUE=pipeGLB[2]"
          />
        <label loc="5 80" size="95 20"
          style="Label1"
          label="Gaussian offset"
          />
        <entry loc="150 80" size="50 20"
          style="PlainText"
          vq="pipeELB[1]"
          vc="pipeGOFF[1]='$VALUE'"
          set="$VALUE=pipeGOFF[1]"
          />
        <entry loc="100 80" size="50 20"
          style="PlainText"
          vq="pipeGOFF[2]"
          vc="pipeGOFF[2]='$VALUE'"
          set="$VALUE=pipeGOFF[2]"
          />
        <label loc="5 105" size="95 20"
          style="Label1"
          label="Max. # iters"
          />
        <entry loc="100 105" size="50 20"
          style="PlainText"
          vq="pipeistIter"
          vc="pipeistIter='$VALUE'"
          set="$VALUE=pipeistIter"
          />
        <label loc="5 125" size="95 20"
          style="Label1"
          label="Threshold (0-1)"
          />
        <entry loc="100 125" size="50 20"
          style="PlainText"
          vq="pipeistTMult"
          vc="pipeistTMult='$VALUE'"
          set="$VALUE=pipeistTMult"
          />
        <label loc="5 145" size="95 20"
          style="Label1"
          label="Scaling (0-1)"
          />
        <entry loc="100 145" size="50 20"
          style="PlainText"
          vq="pipeistCMult"
          vc="pipeistCMult='$VALUE'"
          set="$VALUE=pipeistCMult"
          />
      </group>
      <label loc="200 5" size="180 25"
        style="Heading2"
        label="Step 2: Setting Options"
        justify="Left"
        />
      <group loc="425 0" size="115 150"
        bg="transparent"
        border="None"
        tab="no"
        enable="no"
        useref="no"
        subtype="Untitled"
        rows="1"
        columns="1"
        >
        <button loc="10 50" size="90 25"
          style="Heading2"
          label="Process"
          vq="CSreconmethod"
          vc="if (CSreconmethod='IST' ) then  NUSprocIST else NUSproc endif"
          bg="transparent"
          decor1="yes"
          halignment="Center"
          valignment="Center"
          />
        <label loc="0 5" size="115 25"
          style="Heading2"
          label="Step 3: Process"
          justify="Left"
          />
      </group>
      <label loc="5 5" size="170 25"
        style="Heading2"
        label="Step 1: Save Raw Data"
        justify="Left"
        />
      <label loc="5 90" size="130 25"
        style="Label1"
        label="Stored under Name"
        />
      <entry loc="0 115" size="175 25"
        style="PlainText"
        vq="svfname"
        vc="svfname='$VALUE'"
        set="$VALUE=svfname"
        />
      <entry loc="5 60" size="175 25"
        style="PlainText"
        vq="svfdir"
        vc="svfdir='$VALUE'"
        set="$VALUE=svfdir"
        />
      <button loc="115 35" size="55 25"
        style="Label3"
        label="Create"
        vq="svfdir"
        vc="mkdir(svfdir)"
        bg="transparent"
        decor1="no"
        halignment="Center"
        valignment="Center"
        />
      <label loc="5 35" size="105 25"
        style="Label1"
        label="Storage Directory"
        />
    </group>
  </group>
</template>
